# polya定理

## 群

给定一个集合$G={\{a,b,c...\}}$和集合G上的二元运算，并满足

1. 封闭性：$a*b=c$
2. 结合律：$(a*b)*c=a*(b*c)$
3. 单位元：$a*e=e*a=a$
4. 逆元：$a*b=b*a=e$，记$b=a^{-1}$

## 置换

$\left(\begin{array}{c}1&2&\dots&n\\a_1&a_2&\dots&a_n\end{array}\right)$表示$i$被$a_i$替换，且$a_i$互不相同

### 置换群

置换群的元素是置换，运算时置换的连接。置换群满足群的四个性质

**重要公式**：$|E_k|*|Z_k|=|G|$，研究的是群的元素个数

### $Z_k$不动置换类

设$G$是$1\dots n$的置换群。若$K$是$1\dots n$中某个元素，$G$中使$K$保持不变的置换的全体，记为$Z_k$，叫做$G$中使$K$保持不动的置换类

## $E_k$（等价类）

设$G$是$1\dots n$的置换群。若$K$是$1\dots n$中的某个元素，$K$在$G$作用下的轨迹，记作$E_k$。即$K$在$G$的作用下所能变化成的所有元素的集合



## 推导

设$D(a_i)$表示在置换$a_i$下不变的元素的个数，可以得到$\sum\limits_{j=1}^n|Z_j|=\sum\limits_{i=1}^sD(a_i)$

左边式子：设$N=\{1,\dots,n\}$中共有$L$个等价类，$N=E_1+E_2+\dots+E_L$，则当$j$和$k$属于同一等价类时，有$|Z_j|=|Z_k|$。所以$\sum\limits_{k=1}^n{|Z_k|}=\sum\limits_{i=1}^L\sum\limits_{k\sub E_i}{Z_k}=\sum\limits_{i=1}^L|E_i|*|Z_i|=L*|G|$

这里的$L$就是我们要求的互异的组合状态的个数，于是我们得出：$L=\frac{1}{G}\sum\limits_{k=1}^n|Z_k|=\frac{1}{|G|}\sum\limits_{j=1}^{s}D(a_j)$，这个式子叫做$Burnside$定理

### 循环

为了找到一种简便的计算$D(a_i)$的方法，记$$(a_1,a_2,\dots,a_n)=\left(\begin{array}{c}a_1&a_2&\dots&a_{n-1}&a_n\\a_2&a_3&\dots&a_n&a_1 \end{array}\right)$$称为$n$阶循环。每个置换都可以写成若干个互不相干的循环的乘积，例如$$\left(\begin{array}{c}1&2&3&4&5\\3&5&1&4&2\end{array}\right)=(13)(25)(4)$$，这样的表示是唯一的。置换的循环节数是上述表示中的循环的个数，例如$(13)(25)(4)$的循环节数为3。

### 例子

我们给$2*2$方阵的每个方块标号，如

| 2    | 1    |
| ---- | ---- |
| 3    | 4    |

构造置换群$G'=\{g_1,g_2,g_3,g_4\},|G|=4$，令$g_i$的循环节数为$c(g_i)(i=1,2,3,4)$

在$G'$的作用下，其中

1. $g_1$表示转$0^o$，即$g_1=(1)(2)(3)(4)$，$c(g_1)=4$
2. $g_2$表示转$90^o$，即$g_2=(4\,3\,2\,1)$，$c(g_2)=1$
3. $g_3$表示转$180^o$，即$g_3=(1\,3)(2\,4)$，$c(g_3)=2$
4. $g_4$表示转$270^o$，即$g_4=(1\,2\,3\,4)$，$c(g_4)=1$

我们可以发现，$g_i$的同一个循环节的对象涂以相同的颜色所有的图像数$m^{c(g_i)}$正好就是$G$中置换$a_i$作用下不变的图像数，即$2^{c(g_1)}=2^4=16=D(a_1)$，$2^{c(g_2)}=2^1=2=D(a_2)$，$2^{c(g_3)}=2^2=4=D(a_3)$，$2^{c(g_4)}=2^1=2=D(a_4)$

**由此可得**：设$G$是$p$个对象的一个置换群，用$m$中颜色涂染$p$个对象，则不同染色方案为$L=\frac{1}{|G|}(m^{c(g_1)}+m^{c(g_2)}+\dots+m^{c(g_s)})$



## 例子

$n\times n$的方阵，每个小格可以涂$m$种颜色，求在可旋转操作下本质不同的方案数

1. 确定置换群：这里有四个置换$0^o,90^o,180^o,270^o$
2. 计算循环节个数：给每个格子顺次编号1到$n^2$，使用二维数组标记置换后的状态，使用搜索计算每个置换的循环节个数
3. 代入公式$L=\frac{1}{|G|}(m^{c(g_1)+m^{c(g_2)}+\dots+m^{c(g_s)}})$



